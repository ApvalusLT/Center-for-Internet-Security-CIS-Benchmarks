<#
.SYNOPSIS
This script allows users to select and run defined script functions or visit the creator's GitHub repository.
#>

# Function Definitions (Add your script functions here)

# LEVEL 1 BYOD 

function Level1BYOD_2_1_1 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block viewing corporate documents in unmanaged apps' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block viewing corporate documents in unmanaged apps' is set to 'Yes'"
}

function Level1BYOD_2_1_2 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Treat AirDrop as an unmanaged destination' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Treat AirDrop as an unmanaged destination' is set to 'Yes'"
}

function Level1BYOD_2_1_3 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Allow copy/paste to be affected by managed open-in' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Allow copy/paste to be affected by managed open-in' is set to 'Yes'"
}

function Level1BYOD_2_2_1 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block Siri while device is locked' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block Siri while device is locked' is set to 'Yes'"
}

function Level1BYOD_2_2_2 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Require Safari fraud warnings' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Require Safari fraud warnings' is set to 'Yes'"
}

function Level1BYOD_2_3_1 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Force encrypted backup' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Force encrypted backup' is set to 'Yes'"
}

function Level1BYOD_2_3_2 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block managed apps from storing data in iCloud' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block managed apps from storing data in iCloud' is set to 'Yes'"
}

function Level1BYOD_2_3_3 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block backup of enterprise books' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block backup of enterprise books' is set to 'Yes'"
}

function Level1BYOD_2_3_4 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block notes and highlights sync for enterprise books' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block notes and highlights sync for enterprise books' is set to 'Yes'"
}

function Level1BYOD_2_3_5 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block iCloud Photos sync' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block iCloud Photos sync' is set to 'Yes'"
}

function Level1BYOD_2_3_6 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block iCloud Photo Library' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block iCloud Photo Library' is set to 'Yes'"
}

function Level1BYOD_2_3_7 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block My Photo Stream' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block My Photo Stream' is set to 'Yes'"
}

function Level1BYOD_2_3_8 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block Handoff' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block Handoff' is set to 'Yes'"
}

function Level1BYOD_2_4_1 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Force Apple Watch wrist detection' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Force Apple Watch wrist detection' is set to 'Yes'"
}

function Level1BYOD_2_4_2 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Require AirPlay outgoing requests pairing password' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Require AirPlay outgoing requests pairing password' is set to 'Yes'"
}

function Level1BYOD_2_4_3 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block Apple Watch auto unlock' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block Apple Watch auto unlock' is set to 'Yes'"
}

function Level1BYOD_2_5_1 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block sending diagnostic and usage data to Apple' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block sending diagnostic and usage data to Apple' is set to 'Yes'"
}

function Level1BYOD_2_5_2 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block screenshots and screen recording' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block screenshots and screen recording' is set to 'Yes'"
}

function Level1BYOD_2_5_4 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Force limited ad tracking' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Force limited ad tracking' is set to 'Yes'"
}

function Level1BYOD_2_5_5 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block trusting new enterprise app authors' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block trusting new enterprise app authors' is set to 'Yes'"
}

function Level1BYOD_2_5_6 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Limit Apple personalized advertising' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Limit Apple personalized advertising' is set to 'Yes'"
}

function Level1BYOD_2_6_1 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block Control Center access in lock screen' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block Control Center access in lock screen' is set to 'Yes'"
}

function Level1BYOD_2_6_3 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block Today view in lock screen' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block Today view in lock screen' is set to 'Yes'"
}

function Level1BYOD_2_6_4 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block Wallet notifications in lock screen' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block Wallet notifications in lock screen' is set to 'Yes'"
}

function Level1BYOD_2_7_1 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Require password' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Require password' is set to 'Yes'"
}

function Level1BYOD_2_7_2 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block simple passwords' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block simple passwords' is set to 'Yes'"
}

function Level1BYOD_2_7_4 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Minimum password length' is set to '6' or greater"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Minimum password length' is set to '6' or greater"
}

function Level1BYOD_2_7_5 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Maximum minutes after screen lock before password is required' is set to 'Immediately'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Maximum minutes after screen lock before password is required' is set to 'Immediately'"
}

function Level1BYOD_2_7_6 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Maximum minutes of inactivity until screen locks' is set to '2' or less"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Maximum minutes of inactivity until screen locks' is set to '2' or less"
}

function Level1BYOD_2_8_1 {
    Write-Host "Running Level 1 BYOD script: Ensure 'Block voice dialing while device is locked' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 1 BYOD script: Ensure 'Block voice dialing while device is locked' is set to 'Yes'"
}


# LEVEL 2 BYOD 

function Level2BYOD_2_5_3 {
    Write-Host "Running Level 2 BYOD script: Ensure 'Block untrusted TLS certificates' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 2 BYOD script: Ensure 'Block untrusted TLS certificates' is set to 'Yes'"
}

function Level2BYOD_2_6_2 {
    Write-Host "Running Level 2 BYOD script: Ensure 'Block Notifications Center access in lock screen' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 2 BYOD script: Ensure 'Block Notifications Center access in lock screen' is set to 'Yes'"
}

function Level2BYOD_2_7_3 {
    Write-Host "Running Level 2 BYOD script: Ensure 'Required password type' is set to 'Alphanumeric'"
    # Add the actual script code here
    "Output from Level 2 BYOD script: Ensure 'Required password type' is set to 'Alphanumeric'"
}

function Level2BYOD_2_7_7 {
    Write-Host "Running Level 2 BYOD script: Ensure 'Block Touch ID and Face ID unlock' is set to 'Yes'"
    # Add the actual script code here
    "Output from Level 2 BYOD script: Ensure 'Block Touch ID and Face ID unlock' is set to 'Yes'"
}

# Add more functions for other sub-options...


# Function to display the selection menu for Level 1 BYOD scripts
function Show-Level1BYOD-Menu {
    [CmdletBinding()]
    param (
        [string]$Prompt = 'Select an option:'
    )

    Write-Host "1. Ensure 'Block viewing corporate documents in unmanaged apps' is set to 'Yes' (2.1.1)"
    Write-Host "2. Ensure 'Treat AirDrop as an unmanaged destination' is set to 'Yes' (2.1.2)"
    Write-Host "3. Ensure 'Allow copy/paste to be affected by managed open-in' is set to 'Yes' (2.1.3)"
    Write-Host "4. Ensure 'Block Siri while device is locked' is set to 'Yes' (2.2.1)"
    Write-Host "5. Ensure 'Require Safari fraud warnings' is set to 'Yes' (2.2.2)"
    Write-Host "6. Ensure 'Force encrypted backup' is set to 'Yes' (2.3.1)"
    Write-Host "7. Ensure 'Block managed apps from storing data in iCloud' is set to 'Yes' (2.3.2)"
    Write-Host "8. Ensure 'Block backup of enterprise books' is set to 'Yes' (2.3.3)"
    Write-Host "9. Ensure 'Block notes and highlights sync for enterprise books' is set to 'Yes' (2.3.4)"
    Write-Host "10. Ensure 'Block iCloud Photos sync' is set to 'Yes' (2.3.5)"
    Write-Host "11. Ensure 'Block iCloud Photo Library' is set to 'Yes' (2.3.6)"
    Write-Host "12. Ensure 'Block My Photo Stream' is set to 'Yes' (2.3.7)"
    Write-Host "13. Ensure 'Block Handoff' is set to 'Yes' (2.3.8)"
    Write-Host "14. Ensure 'Force Apple Watch wrist detection' is set to 'Yes' (2.4.1)"
    Write-Host "15. Ensure 'Require AirPlay outgoing requests pairing password' is set to 'Yes' (2.4.2)"
    Write-Host "16. Ensure 'Block Apple Watch auto unlock' is set to 'Yes' (2.4.3)"
    Write-Host "17. Ensure 'Block sending diagnostic and usage data to Apple' is set to 'Yes' (2.5.1)"
    Write-Host "18. Ensure 'Block screenshots and screen recording' is set to 'Yes' (2.5.2)"
    Write-Host "19. Ensure 'Force limited ad tracking' is set to 'Yes' (2.5.4)"
    Write-Host "20. Ensure 'Block trusting new enterprise app authors' is set to 'Yes' (2.5.5)"
    Write-Host "21. Ensure 'Limit Apple personalized advertising' is set to 'Yes' (2.5.6)"
    Write-Host "22. Ensure 'Block Control Center access in lock screen' is set to 'Yes' (2.6.1)"
    Write-Host "23. Ensure 'Block Today view in lock screen' is set to 'Yes' (2.6.3)"
    Write-Host "24. Ensure 'Block Wallet notifications in lock screen' is set to 'Yes' (2.6.4)"
    Write-Host "25. Ensure 'Require password' is set to 'Yes' (2.7.1)"
    Write-Host "26. Ensure 'Block simple passwords' is set to 'Yes' (2.7.2)"
    Write-Host "27. Ensure 'Minimum password length' is set to '6' or greater (2.7.4)"
    Write-Host "28. Ensure 'Maximum minutes after screen lock before password is required' is set to 'Immediately' (2.7.5)"
    Write-Host "29. Ensure 'Maximum minutes of inactivity until screen locks' is set to '2' or less (2.7.6)"
    Write-Host "30. Ensure 'Block voice dialing while device is locked' is set to 'Yes' (2.8.1)"
    # Add more options for other sub-options...
    Write-Host "b. Back to main menu"
    Write-Host "q. Quit"
    Write-Host ""
    Write-Host $Prompt
}

# Function to display the selection menu for Level 2 BYOD scripts
function Show-Level2BYOD-Menu {
    [CmdletBinding()]
    param (
        [string]$Prompt = 'Select an option:'
    )
    Write-Host "1. Ensure 'Ensure 'Block untrusted TLS certificates' is set to 'Yes' (2.5.3)"
    Write-Host "2. Ensure 'Ensure 'Block Notifications Center access in lock screen' is set to 'Yes' (2.6.2)"
    Write-Host "3. Ensure 'Ensure 'Required password type' is set to 'Alphanumeric' (2.7.3)"
    Write-Host "4. Ensure 'Block Touch ID and Face ID unlock' is set to 'Yes' (2.7.7)"
    # Add more options for other sub-options...
    Write-Host "b. Back to main menu"
    Write-Host "q. Quit"
    Write-Host ""
    Write-Host $Prompt
}



# Function to display the main menu
function Show-Menu {
    [CmdletBinding()]
    param (
        [string]$Prompt = 'Select an option:'
    )

    Write-Host "1. Run Level 1 BYOD scripts"
    Write-Host "2. Run Level 2 BYOD scripts"
    Write-Host "3. Run Level 1 Supervised scripts"
    Write-Host "4. Run Level 2 Supervised scripts"
    Write-Host "5. Run all scripts from Level 1 BYOD and Level 2 BYOD"
    Write-Host "6. Run all scripts from Level 1 Supervised and Level 2 Supervised"
    Write-Host "7. Visit creator's GitHub repository"
    Write-Host "q. Quit"
    Write-Host ""
    Write-Host $Prompt
}

# Function to run the selected script
function Run-Script {
    param (
        [string]$SelectedScript
    )

    Write-Host "Running script: $SelectedScript"
    try {
        $output = Invoke-Expression "& $SelectedScript"
        Write-Host "Output from $($SelectedScript):`n$output"
        Write-Host "Script $SelectedScript completed successfully."
    } catch {
        Write-Host "An error occurred while running script ${SelectedScript}: $_"
    }
}

# Function to run all scripts from a given category
function Run-ScriptsFromCategory {
    param (
        [string]$Category
    )

    $categoryScripts = Get-Command -Type Function | Where-Object { $_.Name -match "^$Category" } | Select-Object -ExpandProperty Name
    foreach ($script in $categoryScripts) {
        Run-Script -SelectedScript $script
    }
}

# Function to visit creator's GitHub repository
function Visit-GitHubRepository {
    $githubLink = "https://github.com/ApvalusLT/Center-for-Internet-Security-CIS-Benchmarks"
    Write-Host "Opening creator's GitHub repository..."
    Start-Process $githubLink
}

# Main logic
while ($true) {
    Show-Menu
    $selection = Read-Host "Enter your selection"

    if ($selection -eq 'q') {
        Write-Host "Exiting."
        break
    } elseif ($selection -eq '1') {
        while ($true) {
            Show-Level1BYOD-Menu
            $level1BYODSelection = Read-Host "Enter your selection (b to go back, q to quit)"

            if ($level1BYODSelection -eq 'b') {
                break
            } elseif ($level1BYODSelection -eq 'q') {
                Write-Host "Exiting."
                exit
            } elseif ($level1BYODSelection -eq '1') {
                Run-Script -SelectedScript "Level1BYOD_2_1_1"
            } elseif ($level1BYODSelection -eq '2') {
                Run-Script -SelectedScript "Level1BYOD_2_1_2"
            } elseif ($level1BYODSelection -eq '3') {
                Run-Script -SelectedScript "Level1BYOD_2_1_3"
            } elseif ($level1BYODSelection -eq '4') {
                Run-Script -SelectedScript "Level1BYOD_2_2_1"
            } elseif ($level1BYODSelection -eq '5') {
                Run-Script -SelectedScript "Level1BYOD_2_2_2"
            } elseif ($level1BYODSelection -eq '6') {
                Run-Script -SelectedScript "Level1BYOD_2_3_1"
            } elseif ($level1BYODSelection -eq '7') {
                Run-Script -SelectedScript "Level1BYOD_2_3_2"
            } elseif ($level1BYODSelection -eq '8') {
                Run-Script -SelectedScript "Level1BYOD_2_3_3"
            } elseif ($level1BYODSelection -eq '9') {
                Run-Script -SelectedScript "Level1BYOD_2_3_4"
            } elseif ($level1BYODSelection -eq '10') {
                Run-Script -SelectedScript "Level1BYOD_2_3_5"
            } elseif ($level1BYODSelection -eq '11') {
                Run-Script -SelectedScript "Level1BYOD_2_3_6"
            } elseif ($level1BYODSelection -eq '12') {
                Run-Script -SelectedScript "Level1BYOD_2_3_7"
            } elseif ($level1BYODSelection -eq '13') {
                Run-Script -SelectedScript "Level1BYOD_2_3_8"
            } elseif ($level1BYODSelection -eq '14') {
                Run-Script -SelectedScript "Level1BYOD_2_4_1"
            } elseif ($level1BYODSelection -eq '15') {
                Run-Script -SelectedScript "Level1BYOD_2_4_2"
            } elseif ($level1BYODSelection -eq '16') {
                Run-Script -SelectedScript "Level1BYOD_2_4_3"
            } elseif ($level1BYODSelection -eq '17') {
                Run-Script -SelectedScript "Level1BYOD_2_5_1"
            } elseif ($level1BYODSelection -eq '18') {
                Run-Script -SelectedScript "Level1BYOD_2_5_2"
            } elseif ($level1BYODSelection -eq '19') {
                Run-Script -SelectedScript "Level1BYOD_2_5_4"
            } elseif ($level1BYODSelection -eq '20') {
                Run-Script -SelectedScript "Level1BYOD_2_5_5"
            } elseif ($level1BYODSelection -eq '21') {
                Run-Script -SelectedScript "Level1BYOD_2_5_6"
            } elseif ($level1BYODSelection -eq '22') {
                Run-Script -SelectedScript "Level1BYOD_2_6_1"
            } elseif ($level1BYODSelection -eq '23') {
                Run-Script -SelectedScript "Level1BYOD_2_6_3"
            } elseif ($level1BYODSelection -eq '24') {
                Run-Script -SelectedScript "Level1BYOD_2_6_4"
            } elseif ($level1BYODSelection -eq '25') {
                Run-Script -SelectedScript "Level1BYOD_2_7_1"
            } elseif ($level1BYODSelection -eq '26') {
                Run-Script -SelectedScript "Level1BYOD_2_7_2"
            } elseif ($level1BYODSelection -eq '27') {
                Run-Script -SelectedScript "Level1BYOD_2_7_4"
            } elseif ($level1BYODSelection -eq '28') {
                Run-Script -SelectedScript "Level1BYOD_2_7_5"
            } elseif ($level1BYODSelection -eq '29') {
                Run-Script -SelectedScript "Level1BYOD_2_7_6"
            } elseif ($level1BYODSelection -eq '30') {
                Run-Script -SelectedScript "Level1BYOD_2_8_1"
            }

            # Add more options for other sub-options...
            else {
                Write-Host "Invalid selection. Please choose a valid option."
            }

            Write-Host ""
        }
    } elseif ($selection -eq '2') {
        while ($true) {
            Show-Level2BYOD-Menu
            $level2BYODSelection = Read-Host "Enter your selection (b to go back, q to quit)"

            if ($level2BYODSelection -eq 'b') {
                break
            } elseif ($level1BYODSelection -eq 'q') {
                Write-Host "Exiting."
                exit
            } elseif ($level2BYODSelection -eq '1') {
                Run-Script -SelectedScript "Level2BYOD_2_5_3"
            } elseif ($level2BYODSelection -eq '2') {
                Run-Script -SelectedScript "Level2BYOD_2_6_2"
            } elseif ($level2BYODSelection -eq '3') {
                Run-Script -SelectedScript "Level2BYOD_2_7_3"
            } elseif ($level2BYODSelection -eq '4') {
                Run-Script -SelectedScript "Level2BYOD_2_7_7"
            }
              else {
                Write-Host "Invalid selection. Please choose a valid option."
            }

            Write-Host ""
        }
    } elseif ($selection -eq '3') {
        # Add logic for running Level 1 Supervised scripts
    } elseif ($selection -eq '4') {
        # Add logic for running Level 2 Supervised scripts
    } elseif ($selection -eq '5') {
        Run-ScriptsFromCategory -Category "Level1BYOD"
        Run-ScriptsFromCategory -Category "Level2BYOD"
        # Add logic for running all scripts from Level 1 BYOD and Level 2 BYOD
    } elseif ($selection -eq '6') {
        Run-ScriptsFromCategory -Category "Level2Supervised"
        Run-ScriptsFromCategory -Category "Level2Supervised"
        # Add logic for running all scripts from Level 1 Supervised and Level 2 Supervised
    } elseif ($selection -eq '7') {
        Visit-GitHubRepository
    } else {
        Write-Host "Invalid selection. Please choose a valid option."
    }

    Write-Host ""
}
